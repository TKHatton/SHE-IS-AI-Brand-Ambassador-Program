<!doctype html>
<html>
  <head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Bot Test</title></head>
  <body style="font-family: system-ui, sans-serif; padding: 2rem;">
    <h1>Bot Test</h1>
    <button id="open" style="padding:.6rem 1rem;">Open Bot</button>

    <!-- 1) ChatKit loader from Quickstart -->
    <script src="https://cdn.platform.openai.com/deployments/chatkit/chatkit.js" async></script>

    <!-- 2) Your domain public key script -->
    <script async src="https://chat.openai.com/chatkit.js"
      data-domain-public-key="domain_pk_68ee67d0f8a48190bd965ad0b6c162e90d67d5421802d6c4"></script>

    <script>
      const WORKFLOW_ID = "wf_68edd48e5e788190b178f7d9e981a00e065480baae7782e9";
      const VERSION = "2"; // or "" for production
      function getCK(){ return window.ChatKit || window.chatkit || window.OpenAIChatKit || null; }

      async function waitForCK(ms=10000){
        const t0 = Date.now();
        return new Promise((res, rej)=>{
          (function tick(){
            const ck = getCK();
            if (ck) return res(ck);
            if (Date.now()-t0 > ms) return rej(new Error("ChatKit loader not found"));
            setTimeout(tick, 150);
          })();
        });
      }

      document.getElementById('open').addEventListener('click', async () => {
        try {
          const ck = await waitForCK();
          if (typeof ck.init === "function") ck.init({});
          const opts = { workflowId: WORKFLOW_ID };
          if (VERSION) opts.version = VERSION;
          if (typeof ck.open === "function") ck.open(opts);
          else alert("ChatKit loaded but no open(); Quickstart sample will show the exact usage for your account.");
        } catch (e) {
          alert(e.message);
          console.error(e);
        }
      });
    </script>
  </body>
</html>
